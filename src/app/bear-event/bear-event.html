<div class="bear-event-container">
  <header class="optimizer-header">
    <h1>Bear Event Optimizer</h1>
  </header>

  <app-rules [rules]="rules" />

  <div class="card">
    <div class="card-header">
      <h2>Generator Settings</h2>
    </div>
    <div class="card-content">
      <form (submit)="generateFormations()">
        <div class="form-grid">
          <div class="form-field">
            <label for="infantry">Infantry Troops</label>
            <input id="infantry" type="number" [(ngModel)]="infantry" name="infantry" placeholder="e.g., 1200000" />
            <p class="tooltip">Total number of infantry you can send.</p>
          </div>

          <div class="form-field">
            <label for="cavalry">Cavalry Troops</label>
            <input id="cavalry" type="number" [(ngModel)]="cavalry" name="cavalry" placeholder="e.g., 800000" />
            <p class="tooltip">Total number of cavalry you can send.</p>
          </div>

          <div class="form-field">
            <label for="archers">Archer Troops</label>
            <input id="archers" type="number" [(ngModel)]="archers" name="archers" placeholder="e.g., 1500000" />
            <p class="tooltip">Total number of archers you can send.</p>
          </div>

          <div class="form-field">
            <label for="numMarches">Available Marches</label>
            <input id="numMarches" type="number" [(ngModel)]="numMarches" name="numMarches" placeholder="e.g., 5" />
            <p class="tooltip">How many join marches can you send at once? (we will use 5 at most)</p>
          </div>

          <div class="form-field">
            <label for="damageRatio">Your Damage vs. Average</label>
            <input id="damageRatio" type="number" step="0.1" [(ngModel)]="damageRatio" name="damageRatio" placeholder="e.g., 4.0" />
            <p class="tooltip">Your rally damage versus an average rally. Most users should keep this number as 1. Change this only if your rally is doing a lot more damage compared to others (e.g. x5 more), then change this to e.g. 5.</p>
          </div>

          <div class="form-field">
            <label for="joinCapacity">Limit Join Capacity</label>
            <input id="joinCapacity" type="number" [(ngModel)]="joinCapacity" name="joinCapacity" placeholder="e.g., 90000" />
            <p class="tooltip">Set a custom troop limit for joining rallies (at most 90 000). Makes more space for others in the alliance.</p>
          </div>

          <div class="checkbox-group">
            <div class="form-field-checkbox">
              <input id="hasAmadeus" type="checkbox" [(ngModel)]="hasAmadeus" name="hasAmadeus" />
              <label for="hasAmadeus">Amadeus Hero Available</label>
            </div>

            <div class="form-field-checkbox">
              <input id="hasMargot" type="checkbox" [(ngModel)]="hasMargot" name="hasMargot" />
              <label for="hasMargot">Margot Hero Available</label>
            </div>
          </div>
        </div>

        <div class="action-button-container">
          <button type="submit" class="generate-button">Generate Formations</button>
        </div>
      </form>
    </div>
  </div>

  @if (computedResult()?.length) {
    <div class="results-section">
      <div class="section-header">
        <h2>Generated Formations</h2>
      </div>
      <div class="results-grid">
        @for (formation of computedResult(); track formation.name) {
          <div class="card result-card">
            <div class="card-header">
              <h3>{{ formation.name }}</h3>
            </div>
            <div class="card-content">
              <div class="troop-info">
                <label>Infantry:</label>
                <span class="troop-value">{{ formation.infantry | number }}</span>
              </div>
              <div class="troop-info">
                <label>Cavalry:</label>
                <span class="troop-value">{{ formation.cavalry | number }}</span>
              </div>
              <div class="troop-info">
                <label>Archers:</label>
                <span class="troop-value">{{ formation.archers | number }}</span>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>
